<!doctype html>
<html lang="fr">

  <head>
    <meta charset="utf-8">

    <title>Formation AngularJS - Admin</title>

    <meta name="description" content="Formation AngularJS">
    <meta name="author" content="Vincent Caillierez">

    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />

    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">

    <link rel="stylesheet" href="css/reveal.css">
    <link rel="stylesheet" href="css/theme/sky.css" id="theme">
    <link rel="stylesheet" href="formation.css">

    <!-- Code syntax highlighting -->
    <link rel="stylesheet" href="lib/css/zenburn.css">

    <!-- Printing and PDF exports -->
    <script>
      var link = document.createElement( 'link' );
      link.rel = 'stylesheet';
      link.type = 'text/css';
      link.href = window.location.search.match( /print-pdf/gi ) ? 'css/print/pdf.css' : 'css/print/paper.css';
      document.getElementsByTagName( 'head' )[0].appendChild( link );
    </script>

    <!--[if lt IE 9]>
    <script src="lib/js/html5shiv.js"></script>
    <![endif]-->
  </head>

  <body ng-controller="appCtrl">

    <div class="reveal">

      <!-- Any section element inside of this container is displayed as a slide -->
      <div class="slides">



        <section class="separator" data-background="images/angular-background.png" data-markdown>
          <script type="text/template">
# Backoffice 2
## Créer une section d'administration
          </script>
        </section>



        <section class="" data-markdown>
          <script type="text/template">
# Backoffice 2 - Introduction

Poursuivons la création de notre backoffice avec ces fonctionnalités :

- Créer, màj, effacer les produits (opérations CRUD).
- Créer et valider des formulaires.
          </script>
        </section>



        <section class="size- separator" data-background="images/angular-background.png" data-markdown>
          <script type="text/template">
# Opérations CRUD
          </script>
        </section>



        <section class="size- leftp" data-markdown>
          <script type="text/template">
## Écrans et routes nécessaires pour CRUD

- Liste produits (`admin.productList`)
- Édition produit (`admin.productEdit`)
- Liste commandes (`admin.orderList`)
- Etc.

Certains écrans vont-ils présenter des difficultés particulières ?
          </script>
        </section>



        <section class="size-s leftp exercise" data-background="images/slide3.jpg" data-markdown>
          <script type="text/template">
## EXERCICE: Créer les routes de l'admin

- Dans `$stateProvider`, déclarez les états présentés précédemment (`admin.productList`, `admin.productEdit`) et associez-leur les vues adéquates, fournies dans le répertoire `products`.
  - ATTENTION : L'état `productEdit` doit contenir un paramètre `:productId` qui matchera l'identifiant du produit à éditer.
- Dans le menu principal, ajoutez deux liens :
  - Un vers la liste des produits ;
  - Un vers la liste des commandes.
- Sortez le menu principal dans une directive custom appelée `adminMenu` que vous incluerez dans les vues `homeView.html`, `productListView.html`, `productEditView.html`...
- Assurez-vous que la navigation entre écrans fonctionnent correctement. (N'oubliez pas le bouton "Nouveau produit", le lien vers la home...).

<solution path="admin_crud/listing_00.html"></solution>
          </script>
        </section>



        <section class="size-xs leftp exercise" data-background="images/slide3.jpg" data-markdown>
          <script type="text/template">
## EXERCICE: Créer un service d'accès aux données

1) Créer un service `productsFactory` avec les méthodes suivantes :

- getProducts()
- saveProduct(product)
- deleteProduct(productId)
- getProduct(productId)

NB. Chaque méthode utilisera la fonction correspondante dans le SDK Kinvey, et retournera une promesse.

2) Implémentez le code des contrôleurs pour la liste des produits et le form :

- Les contrôleurs utiliseront bien-sûr `productsFactory`.
- RAPPEL: les méthodes de `productsFactory` renvoient des promesses.
- Vous afficherez des messages de confirmation à l'utilisateur avec `flashMessageService`.

<solution path="admin_crud/listing_01.html"></solution>
          </script>
        </section>



        <section class="size-xs leftp" data-markdown>
          <script type="text/template">
## Améliorations possibles

**RÉUTILISABILITÉ :**

- Écrire un contrôle générique qui gère les opérations CRUD sur toutes les collections, pas que `products`.

**PAGINATION :**

- Si peu de données, peut être **gérée sur le client** grâce à un filtre AngularJS (*) : toutes les données sont récupérées, mais seules celles de la page en cours sont affichées. Voir http://jsfiddle.net/2ZzZB/56/.
- Si le data store supporte la pagination, AngularJS peut **requêter uniquement les données de la page en cours**. Exemple avec le SDK Kinvey :
```
var query = new $kinvey.Query();
query.limit(20);
query.skip(0);  // Première page, montre les résultats 0 à 20.
query.skip(20); // Première page, montre les résultats 20 à 40.
```
- Directives contrib [angular-ui pagination](https://angular-ui.github.io/bootstrap/#/pagination) OU [angularUtils pagination](https://github.com/michaelbromley/angularUtils/tree/master/src/directives/pagination)

(*) Brian Ford dit : "I'd avoid using a filter to separate the pages. You should break up the items into pages within the controller."
          </script>
        </section>


        <section class="size-s separator" data-background="images/angular-background.png" data-markdown>
          <script type="text/template">
# Récap

### Déporter le code dans un service
### `resolve`
          </script>
        </section>


      </div>

    </div>

    <script src="lib/js/head.min.js"></script>
    <script src="js/reveal.js"></script>
    <script src="js/angular.js"></script>
    <script src="formation.js"></script>

  </body>
</html>
